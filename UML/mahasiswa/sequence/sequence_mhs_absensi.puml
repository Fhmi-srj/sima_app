@startuml Sequence Diagram - Melakukan Absensi Mahasiswa

title Sequence Diagram: Melakukan Absensi Mahasiswa

actor Mahasiswa as mhs
participant "Modal Absensi" as modal
participant "Attendance Controller" as ctrl
participant "WiFi Service" as wifi
database "Database" as db

mhs -> modal : Tap jadwal aktif
activate modal

modal -> ctrl : getScheduleDetail(schedule_id)
activate ctrl
ctrl --> modal : Schedule info
deactivate ctrl

modal --> mhs : Tampilkan detail jadwal

modal -> wifi : checkWiFiConnection()
activate wifi
wifi --> modal : Connection status
deactivate wifi

alt Terhubung WiFi Kampus
    modal --> mhs : Status: Terhubung ✓\nTombol "Hadir" aktif
    
    mhs -> modal : Tap tombol Hadir
    modal -> ctrl : submitAttendance(nim, schedule_id)
    activate ctrl
    
    ctrl -> db : INSERT attendance (nim, schedule_id, timestamp, status='hadir')
    activate db
    db --> ctrl : Success
    deactivate db
    
    ctrl --> modal : Attendance recorded
    deactivate ctrl
    
    modal --> mhs : Tampilkan pesan sukses\nStatus: Hadir ✓
    
else Tidak Terhubung WiFi
    modal --> mhs : Status: Tidak Terhubung ✗\nTombol "Hadir" nonaktif
    modal --> mhs : Tampilkan opsi "Ajukan Izin"
    
    opt Ajukan Izin
        mhs -> modal : Tap "Ajukan Izin"
        modal --> mhs : Buka form izin
    end
end

mhs -> modal : Tutup modal
deactivate modal

@enduml
